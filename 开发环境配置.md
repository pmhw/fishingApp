# 微信小程序开发环境配置流程

## 一、环境要求

### 1. 操作系统
- Windows 10/11
- macOS 10.14+
- Linux (Ubuntu 18.04+)

### 2. 必需软件
- **Node.js**: 版本 14.0.0 或更高
- **微信开发者工具**: 最新稳定版
- **Git**: 用于版本控制（可选）

## 二、安装步骤

### 1. 安装 Node.js

#### Windows
1. 访问 [Node.js 官网](https://nodejs.org/)
2. 下载 LTS 版本（推荐）
3. 运行安装程序，按提示完成安装
4. 验证安装：
   ```bash
   node -v
   npm -v
   ```

#### macOS
```bash
# 使用 Homebrew 安装
brew install node

# 或从官网下载安装包
```

#### Linux
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 验证安装
node -v
npm -v
```

### 2. 安装微信开发者工具

1. 访问 [微信开发者工具官网](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. 下载对应系统的安装包
3. 安装并启动微信开发者工具
4. 使用微信扫码登录

### 3. 安装 Git（可选）

#### Windows
- 访问 [Git 官网](https://git-scm.com/download/win)
- 下载并安装 Git for Windows

#### macOS
```bash
# 使用 Homebrew
brew install git

# 或从官网下载
```

#### Linux
```bash
# Ubuntu/Debian
sudo apt-get install git

# CentOS/RHEL
sudo yum install git
```

## 三、项目初始化

### 1. 获取项目代码

#### 方式一：从 Git 仓库克隆
```bash
git clone <项目仓库地址>
cd miniprogram-2
```

#### 方式二：直接使用现有项目
```bash
cd miniprogram-2
```

### 2. 安装项目依赖

```bash
# 安装 npm 依赖
npm install

# 或使用 yarn
yarn install
```

**项目依赖说明：**
- `@vant/weapp`: Vant Weapp UI 组件库 (v1.11.7)
- `vant-green`: Vant 绿色主题 (v1.0.44)

### 3. 构建 npm 包

1. 打开微信开发者工具
2. 点击菜单：**工具** → **构建 npm**
3. 等待构建完成，会在 `miniprogram_npm` 目录生成构建后的文件

**注意：** 如果修改了 `package.json`，需要重新构建 npm

## 四、微信开发者工具配置

### 1. 导入项目

1. 打开微信开发者工具
2. 选择 **导入项目**
3. 填写项目信息：
   - **项目目录**：选择项目根目录（包含 `app.json` 的目录）
   - **AppID**：填写小程序 AppID（测试可使用测试号）
   - **项目名称**：自定义项目名称

### 2. 项目设置

在微信开发者工具中，点击右上角 **详情**，配置以下设置：

#### 本地设置
- ✅ **不校验合法域名**：开发阶段建议开启
- ✅ **不校验 TLS 版本**：开发阶段建议开启
- ✅ **不校验安全域名**：开发阶段建议开启

#### 编译设置
- **编译模式**：普通编译
- **基础库版本**：选择 2.30.4 或更高
- **ES6 转 ES5**：✅ 开启
- **增强编译**：✅ 开启
- **上传代码时样式自动补全**：✅ 开启

#### 项目设置
- **启用自定义处理命令**：根据需求配置
- **启用 npm 模块**：✅ 开启
- **使用 npm 模块路径**：`miniprogram_npm`

### 3. 配置 AppID

在 `project.config.json` 中配置你的 AppID：
```json
{
  "appid": "你的小程序AppID"
}
```

**获取 AppID：**
1. 访问 [微信公众平台](https://mp.weixin.qq.com/)
2. 登录并创建小程序
3. 在 **开发** → **开发管理** → **开发设置** 中获取 AppID

## 五、项目结构说明

```
miniprogram-2/
├── app.js                 # 小程序入口文件
├── app.json               # 小程序全局配置
├── app.wxss               # 小程序全局样式
├── package.json           # npm 依赖配置
├── project.config.json    # 项目配置文件
├── sitemap.json           # 站点地图配置
├── components/            # 自定义组件目录
│   └── navBar/           # 自定义导航栏组件
├── pages/                 # 页面目录
│   ├── home/             # 首页
│   ├── nearby/           # 附近钓场
│   ├── member-code/      # 会员码
│   ├── records/          # 垂钓记录
│   └── profile/          # 个人中心
├── images/                # 图片资源目录
│   ├── tabbar/           # 底部导航栏图标
│   └── icons/            # 图标资源
├── utils/                 # 工具函数目录
├── miniprogram_npm/       # npm 构建后的文件（自动生成）
└── node_modules/          # npm 依赖包（自动生成）
```

## 六、运行项目

### 1. 启动开发

1. 在微信开发者工具中打开项目
2. 点击 **编译** 按钮
3. 在模拟器中查看效果

### 2. 预览

1. 点击工具栏 **预览** 按钮
2. 使用微信扫码在手机上预览

### 3. 真机调试

1. 点击工具栏 **真机调试** 按钮
2. 使用微信扫码连接真机
3. 可以在真机上调试并查看日志

## 七、常见问题解决

### 1. npm 构建失败

**问题**：构建 npm 时提示找不到模块

**解决方案**：
```bash
# 删除 node_modules 和 miniprogram_npm
rm -rf node_modules miniprogram_npm

# 重新安装依赖
npm install

# 在微信开发者工具中重新构建 npm
```

### 2. 组件引入失败

**问题**：提示找不到组件

**解决方案**：
- 检查 `usingComponents` 中的路径是否正确
- 确保组件目录结构完整（包含 .js, .wxml, .wxss, .json）
- 检查 `app.json` 中是否正确配置了组件路径

### 3. 样式不生效

**问题**：样式没有正确应用

**解决方案**：
- 检查样式文件路径是否正确
- 确认 `app.wxss` 中是否引入了全局样式
- 检查是否有样式冲突

### 4. 自定义导航栏不显示

**问题**：自定义导航栏没有显示

**解决方案**：
- 确认页面 json 中设置了 `"navigationStyle": "custom"`
- 检查组件是否正确引入
- 确认 `app.js` 中已初始化 `globalSystemInfo`

### 5. 图标文件缺失

**问题**：底部导航栏图标不显示

**解决方案**：
- 检查 `images/tabbar/` 目录下是否有对应的图标文件
- 确认 `app.json` 中图标路径正确
- 如果没有图标，tabBar 会只显示文字（功能正常）

## 八、开发规范

### 1. 代码规范
- 使用 2 个空格缩进
- 使用单引号
- 变量命名使用驼峰命名法
- 组件命名使用短横线命名法

### 2. 文件命名
- 页面文件：小写字母，使用短横线（如：`member-code`）
- 组件文件：小写字母，使用短横线（如：`nav-bar`）
- 工具文件：小写字母，使用短横线（如：`util.js`）

### 3. 目录结构
- 每个页面/组件包含 4 个文件：`.js`, `.wxml`, `.wxss`, `.json`
- 图片资源统一放在 `images/` 目录
- 工具函数放在 `utils/` 目录

## 九、开发工具推荐

### 代码编辑器
- **VS Code**（推荐）
  - 插件：微信小程序开发工具
  - 插件：WXML - Language Service
  - 插件：minapp-vscode

### 调试工具
- **微信开发者工具**：官方调试工具
- **vConsole**：移动端调试工具（可选）

## 十、版本管理

### Git 配置（可选）

```bash
# 初始化 Git 仓库
git init

# 创建 .gitignore 文件
echo "node_modules/
miniprogram_npm/
.DS_Store
*.log" > .gitignore

# 提交代码
git add .
git commit -m "初始提交"
```

## 十一、后续开发

### 1. 添加新页面
1. 在 `pages/` 目录下创建页面文件夹
2. 创建 4 个文件：`.js`, `.wxml`, `.wxss`, `.json`
3. 在 `app.json` 的 `pages` 数组中添加页面路径

### 2. 添加新组件
1. 在 `components/` 目录下创建组件文件夹
2. 创建 4 个文件：`.js`, `.wxml`, `.wxss`, `.json`
3. 在组件的 `.json` 中设置 `"component": true`
4. 在使用页面的 `.json` 中引入组件

### 3. 使用第三方组件
1. 通过 npm 安装组件库
2. 在微信开发者工具中构建 npm
3. 在页面 json 中引入组件

## 十二、部署上线

### 1. 上传代码
1. 在微信开发者工具中点击 **上传**
2. 填写版本号和项目备注
3. 上传成功后，在微信公众平台提交审核

### 2. 提交审核
1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入 **版本管理**
3. 选择上传的版本，提交审核

### 3. 发布
审核通过后，点击 **发布** 即可上线

---

## 快速检查清单

- [ ] Node.js 已安装（版本 ≥ 14.0.0）
- [ ] 微信开发者工具已安装
- [ ] 项目代码已获取
- [ ] npm 依赖已安装（`npm install`）
- [ ] npm 包已构建（在开发者工具中）
- [ ] AppID 已配置
- [ ] 项目可以正常编译运行
- [ ] 可以在模拟器中查看效果

---

**最后更新：** 2026-01-30
