<!--pages/product-detail/product-detail.wxml-->
<view class="container">
  <!-- å•†å“å›¾ç‰‡è½®æ’­ -->
  <swiper 
    class="product-swiper" 
    indicator-dots="{{true}}" 
    autoplay="{{false}}" 
    interval="5000" 
    duration="500"
    circular="{{true}}"
  >
    <swiper-item wx:for="{{product.images}}" wx:key="index">
      <view class="swiper-image">
        <text class="image-placeholder">ğŸ›ï¸</text>
      </view>
    </swiper-item>
  </swiper>

  <!-- å•†å“åŸºæœ¬ä¿¡æ¯ -->
  <view class="product-info">
    <view class="price-section">
      <text class="price-symbol">Â¥</text>
      <text class="product-price">{{product.price}}</text>
      <text class="original-price" wx:if="{{product.originalPrice}}">Â¥{{product.originalPrice}}</text>
    </view>
    <text class="product-name">{{product.name}}</text>
    <text class="product-subtitle" wx:if="{{product.subtitle}}">{{product.subtitle}}</text>
  </view>

  <!-- å•†å“æ ‡ç­¾ -->
  <view class="product-tags" wx:if="{{product.tags && product.tags.length > 0}}">
    <view class="tag-item" wx:for="{{product.tags}}" wx:key="*this" wx:for-item="tag">
      <text class="tag-text">{{tag}}</text>
    </view>
  </view>

  <!-- è§„æ ¼é€‰æ‹© -->
  <view class="spec-section" bindtap="onSpecTap">
    <view class="spec-label">
      <text class="label-text">é€‰æ‹©è§„æ ¼</text>
      <text class="spec-value">{{selectedSpec || 'è¯·é€‰æ‹©è§„æ ¼'}}</text>
    </view>
    <text class="arrow-right">></text>
  </view>

  <!-- æ•°é‡é€‰æ‹© -->
  <view class="quantity-section">
    <text class="quantity-label">æ•°é‡</text>
    <view class="quantity-control">
      <view class="quantity-btn minus" bindtap="onQuantityChange" data-type="minus">
        <text class="btn-text">-</text>
      </view>
      <input class="quantity-input" type="number" value="{{quantity}}" bindinput="onQuantityInput" />
      <view class="quantity-btn plus" bindtap="onQuantityChange" data-type="plus">
        <text class="btn-text">+</text>
      </view>
    </view>
  </view>

  <!-- å•†å“è¯¦æƒ… -->
  <view class="detail-section">
    <view class="section-title">å•†å“è¯¦æƒ…</view>
    <view class="detail-content">
      <text class="detail-text">{{product.description || 'æš‚æ— è¯¦æƒ…'}}</text>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="bar-left">
      <view class="bar-btn contact-btn" bindtap="onContact">
        <text class="btn-icon">ğŸ’¬</text>
        <text class="btn-text">å®¢æœ</text>
      </view>
      <view class="bar-btn cart-btn" bindtap="onAddToCart">
        <text class="btn-icon">ğŸ›’</text>
        <text class="btn-text">è´­ç‰©è½¦</text>
      </view>
    </view>
    <view class="bar-right">
      <view class="buy-btn add-cart" bindtap="onAddToCart">
        <text class="btn-text">åŠ å…¥è´­ç‰©è½¦</text>
      </view>
      <view class="buy-btn buy-now" bindtap="onBuyNow">
        <text class="btn-text">ç«‹å³è´­ä¹°</text>
      </view>
    </view>
  </view>

  <!-- è§„æ ¼é€‰æ‹©å¼¹çª— -->
  <view class="spec-modal" wx:if="{{showSpecModal}}" bindtap="onSpecModalClose">
    <view class="modal-content" catchtap="true">
      <view class="modal-header">
        <view class="modal-image">
          <text class="image-placeholder">ğŸ›ï¸</text>
        </view>
        <view class="modal-info">
          <text class="modal-price">Â¥{{product.price}}</text>
          <text class="modal-name">{{product.name}}</text>
          <text class="modal-spec">å·²é€‰ï¼š{{selectedSpec}}</text>
        </view>
        <text class="modal-close" bindtap="onSpecModalClose">âœ•</text>
      </view>
      <view class="modal-body">
        <view class="spec-group" wx:for="{{product.specs}}" wx:key="name" wx:for-item="specGroup">
          <text class="spec-group-title">{{specGroup.name}}</text>
          <view class="spec-options">
            <view 
              class="spec-option {{selectedSpecs[specGroup.name] === item ? 'active' : ''}}"
              wx:for="{{specGroup.options}}" 
              wx:key="*this" 
              wx:for-item="item"
              bindtap="onSpecSelect"
              data-group="{{specGroup.name}}"
              data-value="{{item}}"
            >
              <text class="option-text">{{item}}</text>
            </view>
          </view>
        </view>
      </view>
      <view class="modal-footer">
        <view class="modal-btn confirm-btn" bindtap="onSpecConfirm">
          <text class="btn-text">ç¡®å®š</text>
        </view>
      </view>
    </view>
  </view>
</view>
