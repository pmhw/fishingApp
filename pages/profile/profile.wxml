<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- ç™»å½•å¼¹çª—ç»„ä»¶ -->
  <login-modal 
    show="{{showLoginModal}}" 
    autoCheck="{{true}}"
    bind:login="onLoginSuccess"
    bind:close="onLoginClose"
  />
  
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="not-logged-in" wx:if="{{!userInfo}}">
    <view class="login-prompt">
      <view class="prompt-icon">ğŸ£</view>
      <text class="prompt-title">æ‚¨è¿˜æœªç™»å½•</text>
      <text class="prompt-desc">ç™»å½•åäº«å—æ›´å¤šä¸“å±æƒç›Š</text>
      <button class="prompt-btn" bindtap="onShowLogin">ç«‹å³ç™»å½•</button>
    </view>
  </view>
  
  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <block wx:else>
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-section">
    <view class="user-header">
      <view class="user-main" bindtap="onUserInfoTap">
        <view class="user-avatar">
          <view class="avatar-border">
            <text class="avatar-icon">ğŸ£</text>
          </view>
        </view>
        <view class="user-info">
          <view class="user-title-row">
            <text class="user-title">{{userLevel.title}}</text>
            <view class="level-badge">
              <text class="level-icon">ğŸ‘‘</text>
              <text class="level-text">{{userLevel.level}}</text>
            </view>
          </view>
          <!-- ç§¯åˆ†è¿›åº¦æ¡ -->
          <view class="points-progress">
            <view class="progress-label">
              <text class="label-text">ç§¯åˆ†å€¼</text>
              <text class="progress-value">{{userLevel.points}}/{{userLevel.pointsMax}}</text>
              <text class="arrow-right">â€º</text>
            </view>
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{userLevel.pointsPercent}}%"></view>
            </view>
          </view>
        </view>
      </view>
      <!-- ç­¾åˆ°æŒ‰é’® -->
      <view class="sign-in-btn" bindtap="onSignIn">
        <text class="sign-text">ç­¾åˆ°</text>
        <view class="sign-dot" wx:if="{{canSignIn}}"></view>
      </view>
    </view>
    
    <!-- å¿«æ·åŠŸèƒ½å…¥å£ -->
    <view class="quick-actions">
      <view 
        class="action-item" 
        wx:for="{{quickActions}}" 
        wx:key="id"
        bindtap="onQuickActionTap"
        data-action="{{item}}"
      >
        <view class="action-icon" style="background: {{item.color}}20">
          <text class="action-emoji">{{item.icon}}</text>
        </view>
        <view class="action-content">
          <text class="action-title">{{item.title}}</text>
          <text class="action-desc">{{item.desc}}</text>
        </view>
      </view>
      <view class="action-more">
        <text class="more-icon">â‹¯</text>
        <text class="more-text">æ›´å¤š</text>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„èµ„äº§ -->
  <view class="assets-section">
    <view class="section-title">æˆ‘çš„èµ„äº§</view>
    <view class="assets-grid">
      <view 
        class="asset-item" 
        wx:for="{{assets}}" 
        wx:key="id"
        bindtap="onAssetTap"
        data-asset="{{item}}"
      >
        <view class="asset-value-row">
          <text class="asset-value">{{item.value}}</text>
          <view class="asset-dot" wx:if="{{item.hasDot}}"></view>
        </view>
        <text class="asset-name">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„è®¢å• -->
  <view class="orders-section">
    <view class="section-title">æˆ‘çš„è®¢å•</view>
    <view class="orders-grid">
      <view 
        class="order-item" 
        wx:for="{{orderTypes}}" 
        wx:key="id"
        bindtap="onOrderTypeTap"
        data-type="{{item}}"
      >
        <view class="order-icon-wrapper">
          <text class="order-icon">{{item.icon}}</text>
          <view class="order-badge" wx:if="{{item.count > 0}}">{{item.count}}</view>
        </view>
        <text class="order-name">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- ä¿ƒé”€æ¨ªå¹… -->
  <view class="promotion-banner" bindtap="onPromotionTap">
    <view class="banner-left">
      <view class="banner-logo">ğŸ£</view>
      <view class="banner-content">
        <text class="banner-title">{{promotionBanner.title}}</text>
        <text class="banner-subtitle">{{promotionBanner.subtitle}}</text>
      </view>
    </view>
    <view class="banner-right">
      <view class="banner-btn">{{promotionBanner.buttonText}}</view>
    </view>
  </view>

  <!-- æœåŠ¡ä¸å·¥å…· -->
  <view class="services-section">
    <view class="section-title">æœåŠ¡ä¸å·¥å…·</view>
    <view class="services-grid">
      <view 
        class="service-item" 
        wx:for="{{services}}" 
        wx:key="id"
        bindtap="onServiceTap"
        data-service="{{item}}"
      >
        <view class="service-icon" style="background: {{item.color}}20">
          <text class="service-emoji">{{item.icon}}</text>
        </view>
        <text class="service-name">{{item.name}}</text>
      </view>
    </view>
  </view>
  </block>
</view>
